Show how many reviews each restaurant has received returning restaurant name and review count. Order the result by review count descending.
SELECT r.name AS restaurant_name, COUNT(rv.review_id) AS review_count
FROM restaurants AS r
LEFT JOIN reviews AS rv
ON r.restaurant_id=rv.restaurant_id
GROUP BY restaurant_name
ORDER BY review_count DESC;

-- List all users who joined this year, return user name, email, and join date, ordered by join date ascending.
SELECT full_name AS user_name,email,join_date
FROM users AS u
WHERE EXTRACT(YEAR FROM join_date) = EXTRACT(YEAR FROM CURRENT_DATE)
order by join_date ASC;

-- Show users who wrote more than 1 reviews, return user full name and review count, ordered by
SELECT full_name,COUNT(review_id) AS review_count
FROM users AS u
JOIN reviews AS rv
ON u.user_id=rv.user_id
GROUP BY full_name
HAVING COUNT(review_id)>1
ORDER BY review_count DESC;

-- Show the restaurant(s) with the longest name, return restaurant name and name length, including all restaurants if there are ties,

SELECT name AS restaurant_name,
       length(name) AS name_length
FROM restaurants
WHERE length(name)=(SELECT max(length(name))
FROM restaurants);

-- Show hotel name, star rating, and hotel category: 'Luxury' (5 stars), 'Premium' (4 stars), 'Standard' (1â€“3 stars), ordered by star rating descending.
SELECT * FROM exploreplaces.hotels;
ALTER TABLE hotels
ADD COLUMN hotel_category VARCHAR(50) AFTER stars;
UPDATE hotels
SET hotel_category = 
    CASE
        WHEN stars = 5 THEN 'Luxury'
        WHEN stars = 4 THEN 'Premium'
        WHEN stars BETWEEN 1 AND 3 THEN 'Standard'
        ELSE 'Standard'
    END
WHERE hotel_id > 0;


-- Calculate how many reviews were posted each month, return the year, month name, and review count, ordered by review count descending.
SELECT COUNT(review_id) AS review_count,
	   YEAR(review_date) AS year,
       MONTHNAME(review_date) AS month_name
FROM reviews
GROUP BY review_id
ORDER BY review_count DESC;

-- Find the restaurant(s) located in the city that has the maximum number of restaurants, return city name and restaurant name, ordered by restaurant name ascending.

SELECT city_name,
       name AS restaurant_name
FROM restaurants r
JOIN cities c 
ON r.city_id = c.city_id
WHERE r.city_id = (
        SELECT city_id
        FROM restaurants
        GROUP BY city_id
        ORDER BY COUNT(*) DESC
        LIMIT 1
      )
ORDER BY restaurant_name ASC;


-- Find all restaurants in Yerevan with an average rating greater than 4.7, return the restaurant name and average rating rounded to two decimal places.
SELECT name AS restaurant_name,
            round(AVG(rating),2) AS avgerage_rating
FROM restaurants AS r
JOIN cities AS c
ON r.city_id=c.city_id
JOIN reviews AS rv
ON r.restaurant_id=rv.restaurant_id
WHERE city_name='Yerevan'
GROUP BY restaurant_name
HAVING AVG(rating)>4.7;

-- Return user name, age, and age group as numeric ranges: <16, 16-25, 26-40, 41-60, 60+, ordered by age ascending.
SELECT full_name AS user_name,age,
   CASE 
	 WHEN age < 16 THEN '<16'
     WHEN age BETWEEN 16 AND 25 THEN '16-25'
     WHEN age BETWEEN 26 AND 40 THEN '26-40'
     WHEN age BETWEEN 41 AND 60 THEN '41-60'
     WHEN age > 60 THEN '60+'
END AS age_range
FROM users
ORDER BY age ASC;

